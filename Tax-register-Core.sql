


   select * from Reports where RepName like '%tax register%'
   
   
   select PAYDATE ,EMP_CODE,EMP_NAME,GENDER,DOJ,DOB,DOL,PANNO,AADHAARNO,UANNO,OEMAILID AS EMAILID,LOC_NAME,DSG_NAME,smop_code as BANKCODE,smop_name AS [BANK NAME],smopno AS BANKACNO,DEPT_NAME AS DEPTNAME,ISNULL(CONVERT(FLOAT,PRJ_BASIC),0) AS PRJ_BASIC,ISNULL(convert(float,PRJ_HRA),0) AS PRJ_HRA,ISNULL(convert(float,PRJ_CONV),0) AS PRJ_CONV,ISNULL(convert(float,PRJ_OTHALL),0) AS [Other Allowance],ISNULL(convert(float,PRJ_CEA),0) AS PRJ_CEA,ISNULL(convert(float,PRJ_SPLALL),0) AS PRJ_SPLALL,ISNULL(convert(float,PRJ_PERALL),0) AS PRJ_PERALL,ISNULL(convert(float,PRJ_SITE),0) AS PRJ_SITE,ISNULL(convert(float,PRJ_OUTFIT),0) AS PRJ_OUTFIT,ISNULL(convert(float,PRJ_ADDALL),0) AS PRJ_ADDALL,ISNULL(convert(float,PRJ_MED),0) AS PRJ_MED,ISNULL(convert(float,YTD_AWARD),0) AS YTD_AWARD,ISNULL(convert(float,YTD_LEAOS),0) AS YTD_LVNCAS,ISNULL(convert(float,PRJ_LTA),0) AS PRJ_LTA,ISNULL(convert(float,YTD_EXGRAT),0) AS YTD_EXGRAT,ISNULL(convert(float,RFA_PERK),0) AS RFA_PERK,ISNULL(convert(float,FURN_PERK),0) AS FURN_PERK,ISNULL(convert(float,CAR_PERK),0) AS CAR_PERK,ISNULL(convert(float,LON_PERK),0) AS LON_PERK,ISNULL(convert(float,GRATUITY),0) AS GRATUITY,ISNULL(convert(float,GAS_PERK),0) AS GAS_PERK,ISNULL(convert(float,SVT_PERK),0) AS SVT_PERK,ISNULL(convert(float,YTD_SVTSAL),0) AS YTD_SVTSAL,ISNULL(convert(float,YTD_DRVSAL),0) AS YTD_DRVSAL,ISNULL(convert(float,YTD_UNIF),0) AS YTD_UNIF,ISNULL(convert(float,YTD_BP),0) AS YTD_BP,ISNULL(convert(float,YTD_RELALL),0) AS YTD_RELALL,ISNULL(convert(float,YTD_VEHMNT),0) AS YTD_VEHMNT,ISNULL(convert(float,YTD_BONUS),0) AS YTD_BONUS ,ISNULL(convert(float,YTD_PERBON),0) AS [Performance Bonus] ,ISNULL(convert(float,YTD_INCENT),0) AS [Incentive] ,ISNULL(convert(float,ADVSAL),0) AS [Advance Salary Paid] ,ISNULL(convert(float,YTD_OT_AMT),0) AS [OVERTIME] ,ISNULL(convert(float,YTD_NOTPAY),0) AS [NOTPAY] ,ISNULL(convert(float,TAX_RIMAMT),0) AS [Taxable Reimbursement Amt ] ,ISNULL(convert(float,PRJ_GROSSP),0) AS PRJ_GROSSP,(ISNULL(CONVERT(FLOAT,PRJ_HRA),0)-ISNULL(CONVERT(FLOAT,TAX_HRA),0)) AS EXEMPT_HRA,(ISNULL(CONVERT(FLOAT,PRJ_CONV),0)-ISNULL(CONVERT(FLOAT,TAX_CONV),0)) AS EXEMPT_CONV  ,(ISNULL(CONVERT(FLOAT,PRJ_LTA),0)-ISNULL(CONVERT(FLOAT,PRJ_LTA),0)) AS EXEMPT_LTA,ISNULL(CONVERT(FLOAT,PRJ_MED),0) AS EXEMPT_MED,  (ISNULL(CONVERT(FLOAT,PRJ_GROSSP),0)-ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)) AS TOT_EXEMPT,ISNULL(convert(float,SAL_PRVEMP),0) AS SAL_PRVEMP  ,(ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)-ISNULL(CONVERT(FLOAT,SAL_PRVEMP),0)) AS [PRJ_GROSSP],ISNULL(convert(float,PRV_PTAX),0) AS PRV_PTAX,ISNULL(convert(float,PRJ_PTAX),0) AS PRJ_PTAX,  ISNULL(convert(float,DEDU_80CCC),0) AS DEDU_80CCC, ISNULL(convert(float,INV_PF),0) AS INV_PF, ISNULL(convert(float,INV_PPF),0) AS INV_PPF, ISNULL(convert(float,INV_ELSS),0) AS INV_ELSS, ISNULL(convert(float,INV_JD),0) AS  INV_JD, ISNULL(convert(float,INV_EMI),0) AS INV_EMI, ISNULL(convert(float,INV_LIP),0) AS INV_LIP, ISNULL(convert(float,PF_PRVEMP),0) AS PF_PRVEMP, ISNULL(convert(float,INV_CEF),0) AS INV_CEF, ISNULL(convert(float,INV_NSC),0) AS INV_NSC,  ISNULL(convert(float,INV_NSS),0) AS INV_NSS,  ISNULL(convert(float,INV_ULIP),0) AS INV_ULIP, ISNULL(convert(float,INV_MIP),0) AS INV_MIP, ISNULL(convert(float,INV_INT),0) AS INV_INT,ISNULL(convert(float,INV_MF),0) AS [Mutual Fund], ISNULL(convert(float,INV_SHARES),0) AS INV_SHARES,ISNULL(convert(float,INV_TOTAL),0) AS INV_TOTAL,ISNULL(convert(float,DEDU_80C),0) AS DEDU_80C,ISNULL(convert(float,DEDU_80D),0) AS DEDU_80D,ISNULL(convert(float,DEDU_80DD),0) AS DEDU_80DD,ISNULL(convert(float,DEDU_80E),0) AS DEDU_80E,ISNULL(convert(float,DEDU_80G),0) AS DEDU_80G,ISNULL(convert(float,DEDU_80GG),0) AS DEDU_80GG,ISNULL(convert(float,DEDU_80L),0) AS DEDU_80L,ISNULL(convert(float,DEDU_80U),0) AS DEDU_80U,ISNULL(convert(float,DEDU_80CCF),0) AS DEDU_80CCF,ISNULL(convert(float,INC_OTHER),0) AS [Income from Other Sources],ISNULL(convert(float,DEDU_TOTAL),0) AS DEDU_TOTAL,ISNULL(convert(float,INC_OTHER),0) AS INC_OTHER,ISNULL(convert(float,TAX_INCOME),0)  AS TAXABLE_INCOME, ISNULL(convert(float,TOTAL_TAX),0)  AS NET_TAX, ISNULL(convert(float,CESS),0) AS 'NETCESS', ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0) AS 'TOTAL NET TAX'  ,  ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0) AS TAX_PRVEMP,  ISNULL(CONVERT(FLOAT,YTD_ITAX),0)+ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS TAX_DED_TILL_DATE,   ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0)-ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0)-ISNULL(CONVERT(FLOAT,YTD_ITAX),0)-ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS BALANCE_TAX  from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,CASE SEX WHEN 2 THEN 'F' ELSE 'M' END AS GENDER,DOJ, DOB,HRDMASTQRY.LOC_NAME,HRDMASTQRY.DSG_NAME,HRDMASTQRY.SMOP_NAME,HRDMASTQRY.SMOP_Code,HRDMASTQRY.DEPT_NAME,HRDMASTQRY.PANNo,HRDMASTQRY.SMOPNO,HRDMASTQRY.UANNo,HRDMASTQRY.OEMAILID,HrdMastQry.AADHAARNO,DOL,field_name, field_value  FROM dbo.PayHist INNER JOIN dbo.HRDHISTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDHISTQRY.EMP_CODE INNER JOIN dbo.HRDMASTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDMASTQRY.EMP_CODE LEFT OUTER JOIN dbo.RntMast ON dbo.PayHist.EMP_CODE = dbo.RntMast.Emp_Code  WHERE  HRDHISTQRY.EMP_CODE=HRDMASTQRY.EMP_CODE AND   HRDHISTQRY.EMP_CODE=PAYHIST.EMP_CODE AND   HRDHISTQRY.PAYDATE=PAYHIST.PAYDATE   AND HRDHISTQRY.PAYDATE BETWEEN {@FDATE} AND {@TDATE} )  d pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[SPLALL],[MED],[DRVALL],[CARALL],[SFTALL],[LIVALL],[LTA],[OSALL],[CTC_ESI],[CTC_BONUS],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS],[PRJ_BASIC],[PRJ_HRA],[PRJ_CONV],[PRJ_OTHALL],[PRJ_CEA],[PRJ_SPLALL],[PRJ_PERALL],[PRJ_SITE],[PRJ_OUTFIT],[PRJ_ADDALL],[YTD_AWARD],[YTD_OTHERN],[YTD_LEAOS],[PRJ_LTA],[YTD_EXGRAT],[RFA_PERK],[FURN_PERK],[CAR_PERK],[LON_PERK],[GRATUITY],[GAS_PERK],[SVT_PERK],[YTD_SVTSAL],[YTD_DRVSAL],[YTD_UNIF],[YTD_BP],[YTD_RELALL],[YTD_VEHMNT],[YTD_BONUS],[YTD_PERBON],[YTD_INCENT],[ADVSAL],[YTD_OT_AMT],[YTD_NOTPAY],[TAX_RIMAMT],[TAX_HRA],[TAX_CONV],[PRJ_MED],[PRJ_GROSSP],[TAX_GROSSP],[SAL_PRVEMP],[PRV_PTAX],[PRJ_PTAX],[DEDU_80CCC],[INV_PF],[INV_PPF],[INV_ELSS],[INV_JD],[INV_EMI],[INV_LIP],[PF_PRVEMP],[INV_CEF],[INV_NSC]  ,[INV_NSS],[INV_ULIP],[INV_MIP],[INV_INT],[INV_MF],[INV_SHARES],[INV_TOTAL],[DEDU_80C],[DEDU_80D],[DEDU_80DD],[DEDU_80E],[DEDU_80G],[DEDU_80GG],[DEDU_80L],[DEDU_80U] ,[DEDU_80CCF],[DEDU_TOTAL],[INC_OTHER],[TAX_INCOME],[TOTAL_TAX],[CESS],[TAX_PRVEMP],[YTD_ITAX],[YTD_CESSPM])) piv 
   
  declare @FDATE date 
  declare @TDATE date
  set @FDATE = '2018-03-01'
  set @TDATE = '2018-03-31' 
  
 -- select PAYDATE ,EMP_CODE,EMP_NAME,GENDER,DOJ,DOB,DOL,DOS,PANNO,AADHAARNO,UANNO,OEMAILID AS EMAILID,LOC_NAME,DSG_NAME,smop_code as BANKCODE,smop_name AS [BANK NAME],smopno AS BANKACNO,DEPT_NAME AS DEPTNAME,ISNULL(CONVERT(FLOAT,PRJ_BASIC),0) AS PRJ_BASIC,ISNULL(convert(float,PRJ_HRA),0) AS PRJ_HRA,ISNULL(convert(float,PRJ_CONV),0) AS PRJ_CONV,ISNULL(convert(float,PRJ_OTHALL),0) AS [Other Allowance],ISNULL(convert(float,PRJ_CEA),0) AS PRJ_CEA,ISNULL(convert(float,PRJ_SPLALL),0) AS PRJ_SPLALL,ISNULL(convert(float,PRJ_PERALL),0) AS PRJ_PERALL,ISNULL(convert(float,PRJ_SITE),0) AS PRJ_SITE,ISNULL(convert(float,PRJ_OUTFIT),0) AS PRJ_OUTFIT,ISNULL(convert(float,PRJ_ADDALL),0) AS PRJ_ADDALL,ISNULL(convert(float,PRJ_MED),0) AS PRJ_MED,ISNULL(convert(float,YTD_AWARD),0) AS YTD_AWARD,ISNULL(convert(float,YTD_LEAOS),0) AS YTD_LVNCAS,ISNULL(convert(float,PRJ_LTA),0) AS PRJ_LTA,ISNULL(convert(float,YTD_EXGRAT),0) AS YTD_EXGRAT,ISNULL(convert(float,RFA_PERK),0) AS RFA_PERK,ISNULL(convert(float,FURN_PERK),0) AS FURN_PERK,ISNULL(convert(float,CAR_PERK),0) AS CAR_PERK,ISNULL(convert(float,LON_PERK),0) AS LON_PERK,ISNULL(convert(float,GRATUITY),0) AS GRATUITY,ISNULL(convert(float,GAS_PERK),0) AS GAS_PERK,ISNULL(convert(float,SVT_PERK),0) AS SVT_PERK,ISNULL(convert(float,YTD_SVTSAL),0) AS YTD_SVTSAL,ISNULL(convert(float,YTD_DRVSAL),0) AS YTD_DRVSAL,ISNULL(convert(float,YTD_UNIF),0) AS YTD_UNIF,ISNULL(convert(float,YTD_BP),0) AS YTD_BP,ISNULL(convert(float,YTD_RELALL),0) AS YTD_RELALL,ISNULL(convert(float,YTD_VEHMNT),0) AS YTD_VEHMNT,ISNULL(convert(float,YTD_BONUS),0) AS YTD_BONUS ,ISNULL(convert(float,YTD_PERBON),0) AS [Performance Bonus] ,ISNULL(convert(float,YTD_INCENT),0) AS [Incentive] ,ISNULL(convert(float,ADVSAL),0) AS [Advance Salary Paid] ,ISNULL(convert(float,YTD_OT_AMT),0) AS [OVERTIME] ,ISNULL(convert(float,YTD_NOTPAY),0) AS [NOTPAY] ,ISNULL(convert(float,TAX_RIMAMT),0) AS [Taxable Reimbursement Amt ] ,ISNULL(convert(float,PRJ_GROSSP),0) AS PRJ_GROSSP,(ISNULL(CONVERT(FLOAT,PRJ_HRA),0)-ISNULL(CONVERT(FLOAT,TAX_HRA),0)) AS EXEMPT_HRA,(ISNULL(CONVERT(FLOAT,PRJ_CONV),0)-ISNULL(CONVERT(FLOAT,TAX_CONV),0)) AS EXEMPT_CONV  ,(ISNULL(CONVERT(FLOAT,PRJ_LTA),0)-ISNULL(CONVERT(FLOAT,PRJ_LTA),0)) AS EXEMPT_LTA,ISNULL(CONVERT(FLOAT,PRJ_MED),0) AS EXEMPT_MED,  (ISNULL(CONVERT(FLOAT,PRJ_GROSSP),0)-ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)) AS TOT_EXEMPT,ISNULL(convert(float,SAL_PRVEMP),0) AS SAL_PRVEMP  ,(ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)-ISNULL(CONVERT(FLOAT,SAL_PRVEMP),0)) AS [PRJ_GROSSP],ISNULL(convert(float,PRV_PTAX),0) AS PRV_PTAX,ISNULL(convert(float,PRJ_PTAX),0) AS PRJ_PTAX,  ISNULL(convert(float,DEDU_80CCC),0) AS DEDU_80CCC, ISNULL(convert(float,INV_PF),0) AS INV_PF, ISNULL(convert(float,INV_PPF),0) AS INV_PPF, ISNULL(convert(float,INV_ELSS),0) AS INV_ELSS, ISNULL(convert(float,INV_JD),0) AS  INV_JD, ISNULL(convert(float,INV_EMI),0) AS INV_EMI, ISNULL(convert(float,INV_LIP),0) AS INV_LIP, ISNULL(convert(float,PF_PRVEMP),0) AS PF_PRVEMP, ISNULL(convert(float,INV_CEF),0) AS INV_CEF, ISNULL(convert(float,INV_NSC),0) AS INV_NSC,  ISNULL(convert(float,INV_NSS),0) AS INV_NSS,  ISNULL(convert(float,INV_ULIP),0) AS INV_ULIP, ISNULL(convert(float,INV_MIP),0) AS INV_MIP, ISNULL(convert(float,INV_INT),0) AS INV_INT,ISNULL(convert(float,INV_MF),0) AS [Mutual Fund], ISNULL(convert(float,INV_SHARES),0) AS INV_SHARES,ISNULL(convert(float,INV_TOTAL),0) AS INV_TOTAL,ISNULL(convert(float,DEDU_80C),0) AS DEDU_80C,ISNULL(convert(float,DEDU_80D),0) AS DEDU_80D,ISNULL(convert(float,DEDU_80DD),0) AS DEDU_80DD,ISNULL(convert(float,DEDU_80E),0) AS DEDU_80E,ISNULL(convert(float,DEDU_80G),0) AS DEDU_80G,ISNULL(convert(float,DEDU_80GG),0) AS DEDU_80GG,ISNULL(convert(float,DEDU_80L),0) AS DEDU_80L,ISNULL(convert(float,DEDU_80U),0) AS DEDU_80U,ISNULL(convert(float,DEDU_80CCF),0) AS DEDU_80CCF,ISNULL(convert(float,INC_OTHER),0) AS [Income from Other Sources],ISNULL(convert(float,DEDU_TOTAL),0) AS DEDU_TOTAL,ISNULL(convert(float,INC_OTHER),0) AS INC_OTHER,ISNULL(convert(float,TAX_INCOME),0)  AS TAXABLE_INCOME, ISNULL(convert(float,TOTAL_TAX),0)  AS NET_TAX, ISNULL(convert(float,CESS),0) AS 'NETCESS', ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0) AS 'TOTAL NET TAX'  ,  ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0) AS TAX_PRVEMP,  ISNULL(CONVERT(FLOAT,YTD_ITAX),0)+ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS TAX_DED_TILL_DATE,   ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0)-ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0)-ISNULL(CONVERT(FLOAT,YTD_ITAX),0)-ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS BALANCE_TAX  from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,CASE SEX WHEN 2 THEN 'F' ELSE 'M' END AS GENDER,DOJ, DOB,DOS,HRDMASTQRY.LOC_NAME,HRDMASTQRY.DSG_NAME,HRDMASTQRY.SMOP_NAME,HRDMASTQRY.SMOP_Code,HRDMASTQRY.DEPT_NAME,HRDMASTQRY.PANNo,HRDMASTQRY.SMOPNO,HRDMASTQRY.UANNo,HRDMASTQRY.OEMAILID,HrdMastQry.AADHAARNO,DOL,field_name, field_value  FROM dbo.PayHist INNER JOIN dbo.HRDHISTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDHISTQRY.EMP_CODE INNER JOIN dbo.HRDMASTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDMASTQRY.EMP_CODE LEFT OUTER JOIN dbo.RntMast ON dbo.PayHist.EMP_CODE = dbo.RntMast.Emp_Code  WHERE  HRDHISTQRY.EMP_CODE=HRDMASTQRY.EMP_CODE AND   HRDHISTQRY.EMP_CODE=PAYHIST.EMP_CODE AND   HRDHISTQRY.PAYDATE=PAYHIST.PAYDATE   AND HRDHISTQRY.PAYDATE BETWEEN @FDATE AND @TDATE )  d pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[SPLALL],[MED],[DRVALL],[CARALL],[SFTALL],[LIVALL],[LTA],[OSALL],[CTC_ESI],[CTC_BONUS],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS],[PRJ_BASIC],[PRJ_HRA],[PRJ_CONV],[PRJ_OTHALL],[PRJ_CEA],[PRJ_SPLALL],[PRJ_PERALL],[PRJ_SITE],[PRJ_OUTFIT],[PRJ_ADDALL],[YTD_AWARD],[YTD_OTHERN],[YTD_LEAOS],[PRJ_LTA],[YTD_EXGRAT],[RFA_PERK],[FURN_PERK],[CAR_PERK],[LON_PERK],[GRATUITY],[GAS_PERK],[SVT_PERK],[YTD_SVTSAL],[YTD_DRVSAL],[YTD_UNIF],[YTD_BP],[YTD_RELALL],[YTD_VEHMNT],[YTD_BONUS],[YTD_PERBON],[YTD_INCENT],[ADVSAL],[YTD_OT_AMT],[YTD_NOTPAY],[TAX_RIMAMT],[TAX_HRA],[TAX_CONV],[PRJ_MED],[PRJ_GROSSP],[TAX_GROSSP],[SAL_PRVEMP],[PRV_PTAX],[PRJ_PTAX],[DEDU_80CCC],[INV_PF],[INV_PPF],[INV_ELSS],[INV_JD],[INV_EMI],[INV_LIP],[PF_PRVEMP],[INV_CEF],[INV_NSC]  ,[INV_NSS],[INV_ULIP],[INV_MIP],[INV_INT],[INV_MF],[INV_SHARES],[INV_TOTAL],[DEDU_80C],[DEDU_80D],[DEDU_80DD],[DEDU_80E],[DEDU_80G],[DEDU_80GG],[DEDU_80L],[DEDU_80U] ,[DEDU_80CCF],[DEDU_TOTAL],[INC_OTHER],[TAX_INCOME],[TOTAL_TAX],[CESS],[TAX_PRVEMP],[YTD_ITAX],[YTD_CESSPM])) piv 
  --union all  
  select PAYDATE ,EMP_CODE,EMP_NAME,GENDER,DOJ,DOB,DOL,DOS,PANNO,AADHAARNO,UANNO,OEMAILID AS EMAILID,LOC_NAME,DSG_NAME,smop_code as BANKCODE,smop_name AS [BANK NAME],smopno AS BANKACNO,DEPT_NAME AS DEPTNAME,ISNULL(CONVERT(FLOAT,PRJ_BASIC),0) AS PRJ_BASIC,ISNULL(convert(float,PRJ_HRA),0) AS PRJ_HRA,ISNULL(convert(float,PRJ_CONV),0) AS PRJ_CONV,ISNULL(convert(float,PRJ_OTHALL),0) AS [Other Allowance],ISNULL(convert(float,PRJ_CEA),0) AS PRJ_CEA,ISNULL(convert(float,PRJ_SPLALL),0) AS PRJ_SPLALL,ISNULL(convert(float,PRJ_PERALL),0) AS PRJ_PERALL,ISNULL(convert(float,PRJ_SITE),0) AS PRJ_SITE,ISNULL(convert(float,PRJ_OUTFIT),0) AS PRJ_OUTFIT,ISNULL(convert(float,PRJ_ADDALL),0) AS PRJ_ADDALL,ISNULL(convert(float,PRJ_MED),0) AS PRJ_MED,ISNULL(convert(float,YTD_AWARD),0) AS YTD_AWARD,ISNULL(convert(float,YTD_LEAOS),0) AS YTD_LVNCAS,ISNULL(convert(float,PRJ_LTA),0) AS PRJ_LTA,ISNULL(convert(float,YTD_EXGRAT),0) AS YTD_EXGRAT,ISNULL(convert(float,RFA_PERK),0) AS RFA_PERK,ISNULL(convert(float,FURN_PERK),0) AS FURN_PERK,ISNULL(convert(float,CAR_PERK),0) AS CAR_PERK,ISNULL(convert(float,LON_PERK),0) AS LON_PERK,ISNULL(convert(float,GRATUITY),0) AS GRATUITY,ISNULL(convert(float,GAS_PERK),0) AS GAS_PERK,ISNULL(convert(float,SVT_PERK),0) AS SVT_PERK,ISNULL(convert(float,YTD_SVTSAL),0) AS YTD_SVTSAL,ISNULL(convert(float,YTD_DRVSAL),0) AS YTD_DRVSAL,ISNULL(convert(float,YTD_UNIF),0) AS YTD_UNIF,ISNULL(convert(float,YTD_BP),0) AS YTD_BP,ISNULL(convert(float,YTD_RELALL),0) AS YTD_RELALL,ISNULL(convert(float,YTD_VEHMNT),0) AS YTD_VEHMNT,ISNULL(convert(float,YTD_BONUS),0) AS YTD_BONUS ,ISNULL(convert(float,YTD_PERBON),0) AS [Performance Bonus] ,ISNULL(convert(float,YTD_INCENT),0) AS [Incentive] ,ISNULL(convert(float,ADVSAL),0) AS [Advance Salary Paid] ,ISNULL(convert(float,YTD_OT_AMT),0) AS [OVERTIME] ,ISNULL(convert(float,YTD_NOTPAY),0) AS [NOTPAY] ,ISNULL(convert(float,TAX_RIMAMT),0) AS [Taxable Reimbursement Amt ] ,ISNULL(convert(float,PRJ_GROSSP),0) AS PRJ_GROSSP,(ISNULL(CONVERT(FLOAT,PRJ_HRA),0)-ISNULL(CONVERT(FLOAT,TAX_HRA),0)) AS EXEMPT_HRA,(ISNULL(CONVERT(FLOAT,PRJ_CONV),0)-ISNULL(CONVERT(FLOAT,TAX_CONV),0)) AS EXEMPT_CONV  ,(ISNULL(CONVERT(FLOAT,PRJ_LTA),0)-ISNULL(CONVERT(FLOAT,PRJ_LTA),0)) AS EXEMPT_LTA,ISNULL(CONVERT(FLOAT,PRJ_MED),0) AS EXEMPT_MED,  (ISNULL(CONVERT(FLOAT,PRJ_GROSSP),0)-ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)) AS TOT_EXEMPT,ISNULL(convert(float,SAL_PRVEMP),0) AS SAL_PRVEMP  ,(ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)-ISNULL(CONVERT(FLOAT,SAL_PRVEMP),0)) AS [PRJ_GROSSP],ISNULL(convert(float,PRV_PTAX),0) AS PRV_PTAX,ISNULL(convert(float,PRJ_PTAX),0) AS PRJ_PTAX,  ISNULL(convert(float,DEDU_80CCC),0) AS DEDU_80CCC, ISNULL(convert(float,INV_PF),0) AS INV_PF, ISNULL(convert(float,INV_PPF),0) AS INV_PPF, ISNULL(convert(float,INV_ELSS),0) AS INV_ELSS, ISNULL(convert(float,INV_JD),0) AS  INV_JD, ISNULL(convert(float,INV_EMI),0) AS INV_EMI, ISNULL(convert(float,INV_LIP),0) AS INV_LIP, ISNULL(convert(float,PF_PRVEMP),0) AS PF_PRVEMP, ISNULL(convert(float,INV_CEF),0) AS INV_CEF, ISNULL(convert(float,INV_NSC),0) AS INV_NSC,  ISNULL(convert(float,INV_NSS),0) AS INV_NSS,  ISNULL(convert(float,INV_ULIP),0) AS INV_ULIP, ISNULL(convert(float,INV_MIP),0) AS INV_MIP, ISNULL(convert(float,INV_INT),0) AS INV_INT,ISNULL(convert(float,INV_MF),0) AS [Mutual Fund], ISNULL(convert(float,INV_SHARES),0) AS INV_SHARES,ISNULL(convert(float,INV_TOTAL),0) AS INV_TOTAL,ISNULL(convert(float,DEDU_80C),0) AS DEDU_80C,ISNULL(convert(float,DEDU_80D),0) AS DEDU_80D,ISNULL(convert(float,DEDU_80DD),0) AS DEDU_80DD,ISNULL(convert(float,DEDU_80E),0) AS DEDU_80E,ISNULL(convert(float,DEDU_80G),0) AS DEDU_80G,ISNULL(convert(float,DEDU_80GG),0) AS DEDU_80GG,ISNULL(convert(float,DEDU_80L),0) AS DEDU_80L,ISNULL(convert(float,DEDU_80U),0) AS DEDU_80U,ISNULL(convert(float,DEDU_80CCF),0) AS DEDU_80CCF,ISNULL(convert(float,INC_OTHER),0) AS [Income from Other Sources],ISNULL(convert(float,DEDU_TOTAL),0) AS DEDU_TOTAL,ISNULL(convert(float,INC_OTHER),0) AS INC_OTHER,ISNULL(convert(float,TAX_INCOME),0)  AS TAXABLE_INCOME, ISNULL(convert(float,TOTAL_TAX),0)  AS NET_TAX, ISNULL(convert(float,CESS),0) AS 'NETCESS', ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0) AS 'TOTAL NET TAX'  ,  ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0) AS TAX_PRVEMP,  ISNULL(CONVERT(FLOAT,YTD_ITAX),0)+ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS TAX_DED_TILL_DATE,   ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0)-ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0)-ISNULL(CONVERT(FLOAT,YTD_ITAX),0)-ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS BALANCE_TAX  from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,CASE SEX WHEN 2 THEN 'F' ELSE 'M' END AS GENDER,DOJ, DOB,DOS,HRDMASTQRY.LOC_NAME,HRDMASTQRY.DSG_NAME,HRDMASTQRY.SMOP_NAME,HRDMASTQRY.SMOP_Code,HRDMASTQRY.DEPT_NAME,HRDMASTQRY.PANNo,HRDMASTQRY.SMOPNO,HRDMASTQRY.UANNo,HRDMASTQRY.OEMAILID,HrdMastQry.AADHAARNO,DOL,field_name, field_value  FROM dbo.PayHist INNER JOIN dbo.HRDHISTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDHISTQRY.EMP_CODE INNER JOIN dbo.HRDMASTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDMASTQRY.EMP_CODE LEFT OUTER JOIN dbo.RntMast ON dbo.PayHist.EMP_CODE = dbo.RntMast.Emp_Code  WHERE  HRDHISTQRY.EMP_CODE=HRDMASTQRY.EMP_CODE AND   HRDHISTQRY.EMP_CODE=PAYHIST.EMP_CODE AND   HRDHISTQRY.PAYDATE=PAYHIST.PAYDATE   AND DOS<@TDATE and DOS>'2017-04-01' and DOS is not null )  d pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[SPLALL],[MED],[DRVALL],[CARALL],[SFTALL],[LIVALL],[LTA],[OSALL],[CTC_ESI],[CTC_BONUS],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS],[PRJ_BASIC],[PRJ_HRA],[PRJ_CONV],[PRJ_OTHALL],[PRJ_CEA],[PRJ_SPLALL],[PRJ_PERALL],[PRJ_SITE],[PRJ_OUTFIT],[PRJ_ADDALL],[YTD_AWARD],[YTD_OTHERN],[YTD_LEAOS],[PRJ_LTA],[YTD_EXGRAT],[RFA_PERK],[FURN_PERK],[CAR_PERK],[LON_PERK],[GRATUITY],[GAS_PERK],[SVT_PERK],[YTD_SVTSAL],[YTD_DRVSAL],[YTD_UNIF],[YTD_BP],[YTD_RELALL],[YTD_VEHMNT],[YTD_BONUS],[YTD_PERBON],[YTD_INCENT],[ADVSAL],[YTD_OT_AMT],[YTD_NOTPAY],[TAX_RIMAMT],[TAX_HRA],[TAX_CONV],[PRJ_MED],[PRJ_GROSSP],[TAX_GROSSP],[SAL_PRVEMP],[PRV_PTAX],[PRJ_PTAX],[DEDU_80CCC],[INV_PF],[INV_PPF],[INV_ELSS],[INV_JD],[INV_EMI],[INV_LIP],[PF_PRVEMP],[INV_CEF],[INV_NSC]  ,[INV_NSS],[INV_ULIP],[INV_MIP],[INV_INT],[INV_MF],[INV_SHARES],[INV_TOTAL],[DEDU_80C],[DEDU_80D],[DEDU_80DD],[DEDU_80E],[DEDU_80G],[DEDU_80GG],[DEDU_80L],[DEDU_80U] ,[DEDU_80CCF],[DEDU_TOTAL],[INC_OTHER],[TAX_INCOME],[TOTAL_TAX],[CESS],[TAX_PRVEMP],[YTD_ITAX],[YTD_CESSPM])) piv 
  
 update Reports set RepFormula='select PAYDATE ,EMP_CODE,EMP_NAME,GENDER,DOJ,DOB,DOL,DOS,PANNO,AADHAARNO,UANNO,OEMAILID AS EMAILID,LOC_NAME,DSG_NAME,smop_code as BANKCODE,smop_name AS [BANK NAME],smopno AS BANKACNO,DEPT_NAME AS DEPTNAME,ISNULL(CONVERT(FLOAT,PRJ_BASIC),0) AS PRJ_BASIC,ISNULL(convert(float,PRJ_HRA),0) AS PRJ_HRA,ISNULL(convert(float,PRJ_CONV),0) AS PRJ_CONV,ISNULL(convert(float,PRJ_OTHALL),0) AS [Other Allowance],ISNULL(convert(float,PRJ_CEA),0) AS PRJ_CEA,ISNULL(convert(float,PRJ_SPLALL),0) AS PRJ_SPLALL,ISNULL(convert(float,PRJ_PERALL),0) AS PRJ_PERALL,ISNULL(convert(float,PRJ_SITE),0) AS PRJ_SITE,ISNULL(convert(float,PRJ_OUTFIT),0) AS PRJ_OUTFIT,ISNULL(convert(float,PRJ_ADDALL),0) AS PRJ_ADDALL,ISNULL(convert(float,PRJ_MED),0) AS PRJ_MED,ISNULL(convert(float,YTD_AWARD),0) AS YTD_AWARD,ISNULL(convert(float,YTD_LEAOS),0) AS YTD_LVNCAS,ISNULL(convert(float,PRJ_LTA),0) AS PRJ_LTA,ISNULL(convert(float,YTD_EXGRAT),0) AS YTD_EXGRAT,ISNULL(convert(float,RFA_PERK),0) AS RFA_PERK,ISNULL(convert(float,FURN_PERK),0) AS FURN_PERK,ISNULL(convert(float,CAR_PERK),0) AS CAR_PERK,ISNULL(convert(float,LON_PERK),0) AS LON_PERK,ISNULL(convert(float,GRATUITY),0) AS GRATUITY,ISNULL(convert(float,GAS_PERK),0) AS GAS_PERK,ISNULL(convert(float,SVT_PERK),0) AS SVT_PERK,ISNULL(convert(float,YTD_SVTSAL),0) AS YTD_SVTSAL,ISNULL(convert(float,YTD_DRVSAL),0) AS YTD_DRVSAL,ISNULL(convert(float,YTD_UNIF),0) AS YTD_UNIF,ISNULL(convert(float,YTD_BP),0) AS YTD_BP,ISNULL(convert(float,YTD_RELALL),0) AS YTD_RELALL,ISNULL(convert(float,YTD_VEHMNT),0) AS YTD_VEHMNT,ISNULL(convert(float,YTD_BONUS),0) AS YTD_BONUS ,ISNULL(convert(float,YTD_PERBON),0) AS [Performance Bonus] ,ISNULL(convert(float,YTD_INCENT),0) AS [Incentive] ,ISNULL(convert(float,ADVSAL),0) AS [Advance Salary Paid] ,ISNULL(convert(float,YTD_OT_AMT),0) AS [OVERTIME] ,ISNULL(convert(float,YTD_NOTPAY),0) AS [NOTPAY] ,ISNULL(convert(float,TAX_RIMAMT),0) AS [Taxable Reimbursement Amt ] ,ISNULL(convert(float,PRJ_GROSSP),0) AS PRJ_GROSSP,(ISNULL(CONVERT(FLOAT,PRJ_HRA),0)-ISNULL(CONVERT(FLOAT,TAX_HRA),0)) AS EXEMPT_HRA,(ISNULL(CONVERT(FLOAT,PRJ_CONV),0)-ISNULL(CONVERT(FLOAT,TAX_CONV),0)) AS EXEMPT_CONV  ,(ISNULL(CONVERT(FLOAT,PRJ_LTA),0)-ISNULL(CONVERT(FLOAT,PRJ_LTA),0)) AS EXEMPT_LTA,ISNULL(CONVERT(FLOAT,PRJ_MED),0) AS EXEMPT_MED,  (ISNULL(CONVERT(FLOAT,PRJ_GROSSP),0)-ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)) AS TOT_EXEMPT,ISNULL(convert(float,SAL_PRVEMP),0) AS SAL_PRVEMP  ,(ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)-ISNULL(CONVERT(FLOAT,SAL_PRVEMP),0)) AS [PRJ_GROSSP],ISNULL(convert(float,PRV_PTAX),0) AS PRV_PTAX,ISNULL(convert(float,PRJ_PTAX),0) AS PRJ_PTAX,  ISNULL(convert(float,DEDU_80CCC),0) AS DEDU_80CCC, ISNULL(convert(float,INV_PF),0) AS INV_PF, ISNULL(convert(float,INV_PPF),0) AS INV_PPF, ISNULL(convert(float,INV_ELSS),0) AS INV_ELSS, ISNULL(convert(float,INV_JD),0) AS  INV_JD, ISNULL(convert(float,INV_EMI),0) AS INV_EMI, ISNULL(convert(float,INV_LIP),0) AS INV_LIP, ISNULL(convert(float,PF_PRVEMP),0) AS PF_PRVEMP, ISNULL(convert(float,INV_CEF),0) AS INV_CEF, ISNULL(convert(float,INV_NSC),0) AS INV_NSC,  ISNULL(convert(float,INV_NSS),0) AS INV_NSS,  ISNULL(convert(float,INV_ULIP),0) AS INV_ULIP, ISNULL(convert(float,INV_MIP),0) AS INV_MIP, ISNULL(convert(float,INV_INT),0) AS INV_INT,ISNULL(convert(float,INV_MF),0) AS [Mutual Fund], ISNULL(convert(float,INV_SHARES),0) AS INV_SHARES,ISNULL(convert(float,INV_TOTAL),0) AS INV_TOTAL,ISNULL(convert(float,DEDU_80C),0) AS DEDU_80C,ISNULL(convert(float,DEDU_80D),0) AS DEDU_80D,ISNULL(convert(float,DEDU_80DD),0) AS DEDU_80DD,ISNULL(convert(float,DEDU_80E),0) AS DEDU_80E,ISNULL(convert(float,DEDU_80G),0) AS DEDU_80G,ISNULL(convert(float,DEDU_80GG),0) AS DEDU_80GG,ISNULL(convert(float,DEDU_80L),0) AS DEDU_80L,ISNULL(convert(float,DEDU_80U),0) AS DEDU_80U,ISNULL(convert(float,DEDU_80CCF),0) AS DEDU_80CCF,ISNULL(convert(float,INC_OTHER),0) AS [Income from Other Sources],ISNULL(convert(float,DEDU_TOTAL),0) AS DEDU_TOTAL,ISNULL(convert(float,INC_OTHER),0) AS INC_OTHER,ISNULL(convert(float,TAX_INCOME),0)  AS TAXABLE_INCOME, ISNULL(convert(float,TOTAL_TAX),0)  AS NET_TAX, ISNULL(convert(float,CESS),0) AS ''NETCESS'', ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0) AS ''TOTAL NET TAX''  ,  ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0) AS TAX_PRVEMP,  ISNULL(CONVERT(FLOAT,YTD_ITAX),0)+ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS TAX_DED_TILL_DATE,   ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0)-ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0)-ISNULL(CONVERT(FLOAT,YTD_ITAX),0)-ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS BALANCE_TAX  from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,CASE SEX WHEN 2 THEN ''F'' ELSE ''M'' END AS GENDER,DOJ, DOB,DOS,HRDMASTQRY.LOC_NAME,HRDMASTQRY.DSG_NAME,HRDMASTQRY.SMOP_NAME,HRDMASTQRY.SMOP_Code,HRDMASTQRY.DEPT_NAME,HRDMASTQRY.PANNo,HRDMASTQRY.SMOPNO,HRDMASTQRY.UANNo,HRDMASTQRY.OEMAILID,HrdMastQry.AADHAARNO,DOL,field_name, field_value  FROM dbo.PayHist INNER JOIN dbo.HRDHISTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDHISTQRY.EMP_CODE INNER JOIN dbo.HRDMASTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDMASTQRY.EMP_CODE LEFT OUTER JOIN dbo.RntMast ON dbo.PayHist.EMP_CODE = dbo.RntMast.Emp_Code  WHERE  HRDHISTQRY.EMP_CODE=HRDMASTQRY.EMP_CODE AND   HRDHISTQRY.EMP_CODE=PAYHIST.EMP_CODE AND   HRDHISTQRY.PAYDATE=PAYHIST.PAYDATE   AND HRDHISTQRY.PAYDATE BETWEEN {@FDATE} AND {@TDATE} )  d pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[SPLALL],[MED],[DRVALL],[CARALL],[SFTALL],[LIVALL],[LTA],[OSALL],[CTC_ESI],[CTC_BONUS],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS],[PRJ_BASIC],[PRJ_HRA],[PRJ_CONV],[PRJ_OTHALL],[PRJ_CEA],[PRJ_SPLALL],[PRJ_PERALL],[PRJ_SITE],[PRJ_OUTFIT],[PRJ_ADDALL],[YTD_AWARD],[YTD_OTHERN],[YTD_LEAOS],[PRJ_LTA],[YTD_EXGRAT],[RFA_PERK],[FURN_PERK],[CAR_PERK],[LON_PERK],[GRATUITY],[GAS_PERK],[SVT_PERK],[YTD_SVTSAL],[YTD_DRVSAL],[YTD_UNIF],[YTD_BP],[YTD_RELALL],[YTD_VEHMNT],[YTD_BONUS],[YTD_PERBON],[YTD_INCENT],[ADVSAL],[YTD_OT_AMT],[YTD_NOTPAY],[TAX_RIMAMT],[TAX_HRA],[TAX_CONV],[PRJ_MED],[PRJ_GROSSP],[TAX_GROSSP],[SAL_PRVEMP],[PRV_PTAX],[PRJ_PTAX],[DEDU_80CCC],[INV_PF],[INV_PPF],[INV_ELSS],[INV_JD],[INV_EMI],[INV_LIP],[PF_PRVEMP],[INV_CEF],[INV_NSC]  ,[INV_NSS],[INV_ULIP],[INV_MIP],[INV_INT],[INV_MF],[INV_SHARES],[INV_TOTAL],[DEDU_80C],[DEDU_80D],[DEDU_80DD],[DEDU_80E],[DEDU_80G],[DEDU_80GG],[DEDU_80L],[DEDU_80U] ,[DEDU_80CCF],[DEDU_TOTAL],[INC_OTHER],[TAX_INCOME],[TOTAL_TAX],[CESS],[TAX_PRVEMP],[YTD_ITAX],[YTD_CESSPM])) piv 
  union all  
  select PAYDATE ,EMP_CODE,EMP_NAME,GENDER,DOJ,DOB,DOL,DOS,PANNO,AADHAARNO,UANNO,OEMAILID AS EMAILID,LOC_NAME,DSG_NAME,smop_code as BANKCODE,smop_name AS [BANK NAME],smopno AS BANKACNO,DEPT_NAME AS DEPTNAME,ISNULL(CONVERT(FLOAT,PRJ_BASIC),0) AS PRJ_BASIC,ISNULL(convert(float,PRJ_HRA),0) AS PRJ_HRA,ISNULL(convert(float,PRJ_CONV),0) AS PRJ_CONV,ISNULL(convert(float,PRJ_OTHALL),0) AS [Other Allowance],ISNULL(convert(float,PRJ_CEA),0) AS PRJ_CEA,ISNULL(convert(float,PRJ_SPLALL),0) AS PRJ_SPLALL,ISNULL(convert(float,PRJ_PERALL),0) AS PRJ_PERALL,ISNULL(convert(float,PRJ_SITE),0) AS PRJ_SITE,ISNULL(convert(float,PRJ_OUTFIT),0) AS PRJ_OUTFIT,ISNULL(convert(float,PRJ_ADDALL),0) AS PRJ_ADDALL,ISNULL(convert(float,PRJ_MED),0) AS PRJ_MED,ISNULL(convert(float,YTD_AWARD),0) AS YTD_AWARD,ISNULL(convert(float,YTD_LEAOS),0) AS YTD_LVNCAS,ISNULL(convert(float,PRJ_LTA),0) AS PRJ_LTA,ISNULL(convert(float,YTD_EXGRAT),0) AS YTD_EXGRAT,ISNULL(convert(float,RFA_PERK),0) AS RFA_PERK,ISNULL(convert(float,FURN_PERK),0) AS FURN_PERK,ISNULL(convert(float,CAR_PERK),0) AS CAR_PERK,ISNULL(convert(float,LON_PERK),0) AS LON_PERK,ISNULL(convert(float,GRATUITY),0) AS GRATUITY,ISNULL(convert(float,GAS_PERK),0) AS GAS_PERK,ISNULL(convert(float,SVT_PERK),0) AS SVT_PERK,ISNULL(convert(float,YTD_SVTSAL),0) AS YTD_SVTSAL,ISNULL(convert(float,YTD_DRVSAL),0) AS YTD_DRVSAL,ISNULL(convert(float,YTD_UNIF),0) AS YTD_UNIF,ISNULL(convert(float,YTD_BP),0) AS YTD_BP,ISNULL(convert(float,YTD_RELALL),0) AS YTD_RELALL,ISNULL(convert(float,YTD_VEHMNT),0) AS YTD_VEHMNT,ISNULL(convert(float,YTD_BONUS),0) AS YTD_BONUS ,ISNULL(convert(float,YTD_PERBON),0) AS [Performance Bonus] ,ISNULL(convert(float,YTD_INCENT),0) AS [Incentive] ,ISNULL(convert(float,ADVSAL),0) AS [Advance Salary Paid] ,ISNULL(convert(float,YTD_OT_AMT),0) AS [OVERTIME] ,ISNULL(convert(float,YTD_NOTPAY),0) AS [NOTPAY] ,ISNULL(convert(float,TAX_RIMAMT),0) AS [Taxable Reimbursement Amt ] ,ISNULL(convert(float,PRJ_GROSSP),0) AS PRJ_GROSSP,(ISNULL(CONVERT(FLOAT,PRJ_HRA),0)-ISNULL(CONVERT(FLOAT,TAX_HRA),0)) AS EXEMPT_HRA,(ISNULL(CONVERT(FLOAT,PRJ_CONV),0)-ISNULL(CONVERT(FLOAT,TAX_CONV),0)) AS EXEMPT_CONV  ,(ISNULL(CONVERT(FLOAT,PRJ_LTA),0)-ISNULL(CONVERT(FLOAT,PRJ_LTA),0)) AS EXEMPT_LTA,ISNULL(CONVERT(FLOAT,PRJ_MED),0) AS EXEMPT_MED,  (ISNULL(CONVERT(FLOAT,PRJ_GROSSP),0)-ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)) AS TOT_EXEMPT,ISNULL(convert(float,SAL_PRVEMP),0) AS SAL_PRVEMP  ,(ISNULL(CONVERT(FLOAT,TAX_GROSSP),0)-ISNULL(CONVERT(FLOAT,SAL_PRVEMP),0)) AS [PRJ_GROSSP],ISNULL(convert(float,PRV_PTAX),0) AS PRV_PTAX,ISNULL(convert(float,PRJ_PTAX),0) AS PRJ_PTAX,  ISNULL(convert(float,DEDU_80CCC),0) AS DEDU_80CCC, ISNULL(convert(float,INV_PF),0) AS INV_PF, ISNULL(convert(float,INV_PPF),0) AS INV_PPF, ISNULL(convert(float,INV_ELSS),0) AS INV_ELSS, ISNULL(convert(float,INV_JD),0) AS  INV_JD, ISNULL(convert(float,INV_EMI),0) AS INV_EMI, ISNULL(convert(float,INV_LIP),0) AS INV_LIP, ISNULL(convert(float,PF_PRVEMP),0) AS PF_PRVEMP, ISNULL(convert(float,INV_CEF),0) AS INV_CEF, ISNULL(convert(float,INV_NSC),0) AS INV_NSC,  ISNULL(convert(float,INV_NSS),0) AS INV_NSS,  ISNULL(convert(float,INV_ULIP),0) AS INV_ULIP, ISNULL(convert(float,INV_MIP),0) AS INV_MIP, ISNULL(convert(float,INV_INT),0) AS INV_INT,ISNULL(convert(float,INV_MF),0) AS [Mutual Fund], ISNULL(convert(float,INV_SHARES),0) AS INV_SHARES,ISNULL(convert(float,INV_TOTAL),0) AS INV_TOTAL,ISNULL(convert(float,DEDU_80C),0) AS DEDU_80C,ISNULL(convert(float,DEDU_80D),0) AS DEDU_80D,ISNULL(convert(float,DEDU_80DD),0) AS DEDU_80DD,ISNULL(convert(float,DEDU_80E),0) AS DEDU_80E,ISNULL(convert(float,DEDU_80G),0) AS DEDU_80G,ISNULL(convert(float,DEDU_80GG),0) AS DEDU_80GG,ISNULL(convert(float,DEDU_80L),0) AS DEDU_80L,ISNULL(convert(float,DEDU_80U),0) AS DEDU_80U,ISNULL(convert(float,DEDU_80CCF),0) AS DEDU_80CCF,ISNULL(convert(float,INC_OTHER),0) AS [Income from Other Sources],ISNULL(convert(float,DEDU_TOTAL),0) AS DEDU_TOTAL,ISNULL(convert(float,INC_OTHER),0) AS INC_OTHER,ISNULL(convert(float,TAX_INCOME),0)  AS TAXABLE_INCOME, ISNULL(convert(float,TOTAL_TAX),0)  AS NET_TAX, ISNULL(convert(float,CESS),0) AS ''NETCESS'', ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0) AS ''TOTAL NET TAX''  ,  ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0) AS TAX_PRVEMP,  ISNULL(CONVERT(FLOAT,YTD_ITAX),0)+ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS TAX_DED_TILL_DATE,   ISNULL(CONVERT(FLOAT,TOTAL_TAX),0) +ISNULL(CONVERT(FLOAT,CESS),0)-ISNULL(CONVERT(FLOAT,TAX_PRVEMP),0)-ISNULL(CONVERT(FLOAT,YTD_ITAX),0)-ISNULL(CONVERT(FLOAT,YTD_CESSPM),0) AS BALANCE_TAX  from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,CASE SEX WHEN 2 THEN ''F'' ELSE ''M'' END AS GENDER,DOJ, DOB,DOS,HRDMASTQRY.LOC_NAME,HRDMASTQRY.DSG_NAME,HRDMASTQRY.SMOP_NAME,HRDMASTQRY.SMOP_Code,HRDMASTQRY.DEPT_NAME,HRDMASTQRY.PANNo,HRDMASTQRY.SMOPNO,HRDMASTQRY.UANNo,HRDMASTQRY.OEMAILID,HrdMastQry.AADHAARNO,DOL,field_name, field_value  FROM dbo.PayHist INNER JOIN dbo.HRDHISTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDHISTQRY.EMP_CODE INNER JOIN dbo.HRDMASTQRY ON dbo.PayHist.EMP_CODE = dbo.HRDMASTQRY.EMP_CODE LEFT OUTER JOIN dbo.RntMast ON dbo.PayHist.EMP_CODE = dbo.RntMast.Emp_Code  WHERE  HRDHISTQRY.EMP_CODE=HRDMASTQRY.EMP_CODE AND   HRDHISTQRY.EMP_CODE=PAYHIST.EMP_CODE AND   HRDHISTQRY.PAYDATE=PAYHIST.PAYDATE   AND DOS<{@TDATE} and DOS>''2017-04-01'' and DOS is not null )  d pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[SPLALL],[MED],[DRVALL],[CARALL],[SFTALL],[LIVALL],[LTA],[OSALL],[CTC_ESI],[CTC_BONUS],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS],[PRJ_BASIC],[PRJ_HRA],[PRJ_CONV],[PRJ_OTHALL],[PRJ_CEA],[PRJ_SPLALL],[PRJ_PERALL],[PRJ_SITE],[PRJ_OUTFIT],[PRJ_ADDALL],[YTD_AWARD],[YTD_OTHERN],[YTD_LEAOS],[PRJ_LTA],[YTD_EXGRAT],[RFA_PERK],[FURN_PERK],[CAR_PERK],[LON_PERK],[GRATUITY],[GAS_PERK],[SVT_PERK],[YTD_SVTSAL],[YTD_DRVSAL],[YTD_UNIF],[YTD_BP],[YTD_RELALL],[YTD_VEHMNT],[YTD_BONUS],[YTD_PERBON],[YTD_INCENT],[ADVSAL],[YTD_OT_AMT],[YTD_NOTPAY],[TAX_RIMAMT],[TAX_HRA],[TAX_CONV],[PRJ_MED],[PRJ_GROSSP],[TAX_GROSSP],[SAL_PRVEMP],[PRV_PTAX],[PRJ_PTAX],[DEDU_80CCC],[INV_PF],[INV_PPF],[INV_ELSS],[INV_JD],[INV_EMI],[INV_LIP],[PF_PRVEMP],[INV_CEF],[INV_NSC]  ,[INV_NSS],[INV_ULIP],[INV_MIP],[INV_INT],[INV_MF],[INV_SHARES],[INV_TOTAL],[DEDU_80C],[DEDU_80D],[DEDU_80DD],[DEDU_80E],[DEDU_80G],[DEDU_80GG],[DEDU_80L],[DEDU_80U] ,[DEDU_80CCF],[DEDU_TOTAL],[INC_OTHER],[TAX_INCOME],[TOTAL_TAX],[CESS],[TAX_PRVEMP],[YTD_ITAX],[YTD_CESSPM])) piv' where RepName like '%tax register%'
  
  
  select DOS,* from HrdMastQry