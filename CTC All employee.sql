


    select * from PayHist where Emp_Code='0500585' and PayDate='2020-02-29 00:00:00.000'
    
    
     
    
    select * from LaMast where EMP_CODE='0500585'
    select * from LaTran where Emp_Code='0500585'
     
    select * from LaMast  where EMP_CODE='0500514' 
    select * from LaTran  where EMP_CODE='0500514'
    
    insert into LaTran(EMP_CODE,L_CODE,L_DATE,L_RDATE,INT,Int_Accr)
    values('0500585','LON_SALADV','2020-02-01 00:00:00.000','2020-02-29 00:00:00.000','11111.00','11111.00')
    
    
    select * from Reports where RepName='CTC By Siddharth'
    
    
    
    Select PAYDATE,EMP_CODE,EMP_NAME,FathHusbName as [FATHER'S NAME],DOJ,dob,DOL as [ DOL ],aadhaarno as [AAdhar No],mmobileno as [Mobile no],gender as [Gender],pfno as [PF No],esino as [ESI No],PANNO,ROUND(ISNULL([BASIC]/12,0),0) as BASIC, ROUND(ISNULL([HRA]/12,0),0)  as HRA, ROUND(ISNULL([SPLALL]/12,0),0) as SPLALL,ROUND(ISNULL(convert(float, CTC_PF,0)/12,0),0) AS PF,ROUND(ISNULL(EESI,0),0)  AS [ESI_EMPLOYER], ROUND(ISNULL([CARLES]/12,0),0) as [CARLES],ROUND(ISNULL([LTA]/12,0),0) as [LTA],ROUND(ISNULL([PTLRIM]/12,0),0) as [CONVEYANCE REIMBURSEMENT],ROUND(ISNULL(DRVRIM,0)/12,0) AS DRVRIM, ROUND(ISNULL(CARMNT,0)/12,0)  AS [FUEL CAR MAINTENANCE], ROUND(ISNULL(PRORIM,0)/12,0)  AS [PROFESSIONAL DEVELOPMENT REIMBURSEMENT], ROUND(ISNULL(ENTRIM,0)/12,0)  AS [ENTERTAINMENT REIMBURSEMENT],ROUND(ISNULL(TELRIM,0)/12,0)  AS TELRIM, ROUND((ISNULL([BASIC]/12,0)+ISNULL([HRA]/12,0)+ISNULL([OTHALL]/12,0)+ISNULL([SPLALL]/12,0)+ISNULL([EDUALL]/12,0)+ISNULL([CARLES]/12,0)+ISNULL([LTA]/12,0)+ISNULL([PTLRIM]/12,0)+ISNULL(MEDRIM,0)/12+ISNULL(TELRIM,0)/12+ISNULL(DRVRIM,0)/12+ISNULL(UNIRIM,0)/12+ISNULL(PRORIM,0)/12+ISNULL(ENTRIM,0)/12+ISNULL(LTARIM,0)/12+ISNULL(NWSRIM,0)/12+ISNULL(CARMNT,0)/12),0)+ISNULL(CTC_PF,0)/12+ISNULL(EESI,0)+ISNULL(ENTRIM/12,0)+ISNULL(FOOD/12,0) +ISNULL(SUDEXO/12,0)+ISNULL([PR_BNS]/12,0)+ISNULL([ST_BNS]/12,0)+ISNULL([PL_ACT]/12,0)+ISNULL([MD_PRM]/12,0) as [MONTHLY CTC] from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,HrdMastQry.FathHusbName,HrdMastQry.DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,HrdMastQry.DOL,HrdMastQry.PANNO, field_name, field_value,RIMHISTQRY.MEDRIM,RIMHISTQRY.TELRIM,RIMHISTQRY.DRVRIM,RIMHISTQRY.UNIRIM, RIMHISTQRY.PTLRIM,RimHistQry.CARMNT,RIMHISTQRY.LTARIM,RIMHISTQRY.NWSRIM,RimHistQry.PRORIM  FROM HRDHISTQRY  LEFT OUTER JOIN HRDMASTQRY ON HRDHISTQRY.EMP_CODE = HRDMASTQRY.EMP_CODE LEFT OUTER JOIN PAYHIST ON HRDHISTQRY.EMP_CODE = PAYHIST.EMP_CODE AND HRDHISTQRY.PAYDATE = PAYHIST.PAYDATE  LEFT OUTER JOIN RIMHISTQRY ON HRDHISTQRY.EMP_CODE = RIMHISTQRY.EMP_CODE AND HRDHISTQRY.PAYDATE = RIMHISTQRY.PAYDATE  LEFT OUTER JOIN PAYMAST ON HRDHISTQRY.EMP_CODE = PAYMAST.EMP_CODE AND PAYMAST.FINYEAR=YEAR(HRDHISTQRY.PAYDATE) WHERE  PAYHIST.PAYDATE BETWEEN {@FDATE} AND {@TDATE} AND HRDHISTQRY.Status_Code='01') d  pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[OTHALL],[SPLALL],[MED],[SFTALL],[EDUALL],[LTA],[CARLES],[OSALL],[CTC_ESI],[CTC_BONUS],[CTC_GRAT],[CTC_RTNBNS],[FOOD],[CTC_MEDCLM],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS])) piv
    
    declare @FDATE date
    declare @TDATE date
    set @FDATE = '2020-02-01'
    set @TDATE = '2020-02-29'
    Select EMP_CODE,EMP_NAME,FathHusbName as [FATHER'S NAME],DOJ,dob,DOL as [ DOL ],aadhaarno as [AAdhar No],mmobileno as [Mobile no],gender as [Gender],pfno as [PF No],esino as [ESI No],PANNO,ROUND(ISNULL([BASIC]/12,0),0) as BASIC, ROUND(ISNULL([HRA]/12,0),0)  as HRA, ROUND(ISNULL([SPLALL]/12,0),0) as SPLALL,ROUND(ISNULL(convert(float, CTC_PF,0)/12,0),0) AS PF,ROUND(ISNULL(EESI,0),0)  AS [ESI_EMPLOYER], ROUND(ISNULL([CARLES]/12,0),0) as [CARLES],ROUND(ISNULL([LTA]/12,0),0) as [LTA],ROUND(ISNULL([PTLRIM]/12,0),0) as [CONVEYANCE REIMBURSEMENT],ROUND(ISNULL(DRVRIM,0)/12,0) AS DRVRIM, ROUND(ISNULL(CARMNT,0)/12,0)  AS [FUEL CAR MAINTENANCE], ROUND(ISNULL(PRORIM,0)/12,0)  AS [PROFESSIONAL DEVELOPMENT REIMBURSEMENT], ROUND(ISNULL(ENTRIM,0)/12,0)  AS [ENTERTAINMENT REIMBURSEMENT],ROUND(ISNULL(TELRIM,0)/12,0)  AS TELRIM, ROUND((ISNULL([BASIC]/12,0)+ISNULL([HRA]/12,0)+ISNULL([OTHALL]/12,0)+ISNULL([SPLALL]/12,0)+ISNULL([EDUALL]/12,0)+ISNULL([CARLES]/12,0)+ISNULL([LTA]/12,0)+ISNULL([PTLRIM]/12,0)+ISNULL(MEDRIM,0)/12+ISNULL(TELRIM,0)/12+ISNULL(DRVRIM,0)/12+ISNULL(UNIRIM,0)/12+ISNULL(PRORIM,0)/12+ISNULL(ENTRIM,0)/12+ISNULL(LTARIM,0)/12+ISNULL(NWSRIM,0)/12+ISNULL(CARMNT,0)/12),0)+ISNULL(CTC_PF,0)/12+ISNULL(EESI,0)+ISNULL(ENTRIM/12,0)+ISNULL(FOOD/12,0) +ISNULL(SUDEXO/12,0)+ISNULL([PR_BNS]/12,0)+ISNULL([ST_BNS]/12,0)+ISNULL([PL_ACT]/12,0)+ISNULL([MD_PRM]/12,0) as [MONTHLY CTC] from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,HrdMastQry.FathHusbName,HrdMastQry.DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,HrdMastQry.DOL,HrdMastQry.PANNO, field_name, field_value,RIMHISTQRY.MEDRIM,RIMHISTQRY.TELRIM,RIMHISTQRY.DRVRIM,RIMHISTQRY.UNIRIM, RIMHISTQRY.PTLRIM,RimHistQry.CARMNT,RIMHISTQRY.LTARIM,RIMHISTQRY.NWSRIM,RimHistQry.PRORIM  FROM HRDHISTQRY  LEFT OUTER JOIN HRDMASTQRY ON HRDHISTQRY.EMP_CODE = HRDMASTQRY.EMP_CODE LEFT OUTER JOIN PAYHIST ON HRDHISTQRY.EMP_CODE = PAYHIST.EMP_CODE AND HRDHISTQRY.PAYDATE = PAYHIST.PAYDATE  LEFT OUTER JOIN RIMHISTQRY ON HRDHISTQRY.EMP_CODE = RIMHISTQRY.EMP_CODE AND HRDHISTQRY.PAYDATE = RIMHISTQRY.PAYDATE  LEFT OUTER JOIN PAYMAST ON HRDHISTQRY.EMP_CODE = PAYMAST.EMP_CODE AND PAYMAST.FINYEAR=YEAR(HRDHISTQRY.PAYDATE) WHERE  HRDHISTQRY.Status_Code in('04')) d  pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[OTHALL],[SPLALL],[MED],[SFTALL],[EDUALL],[LTA],[CARLES],[OSALL],[CTC_ESI],[CTC_BONUS],[CTC_GRAT],[CTC_RTNBNS],[FOOD],[CTC_MEDCLM],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS])) piv 
    group by EMP_CODE,EMP_NAME,FathHusbName,DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,DOL,PANNO,MEDRIM,TELRIM,DRVRIM,UNIRIM, PTLRIM,CARMNT,LTARIM,NWSRIM,PRORIM , BASIC,HRA,SPLALL, CTC_PF,EESI,CARLES,LTA,ENTRIM,OTHALL,EDUALL,FOOD,SUDEXO,PR_BNS,ST_BNS,PL_ACT,MD_PRM
    union all
    Select EMP_CODE,EMP_NAME,FathHusbName as [FATHER'S NAME],DOJ,dob,DOL as [ DOL ],aadhaarno as [AAdhar No],mmobileno as [Mobile no],gender as [Gender],pfno as [PF No],esino as [ESI No],PANNO,ROUND(ISNULL([BASIC]/12,0),0) as BASIC, ROUND(ISNULL([HRA]/12,0),0)  as HRA, ROUND(ISNULL([SPLALL]/12,0),0) as SPLALL,ROUND(ISNULL(convert(float, CTC_PF,0)/12,0),0) AS PF,ROUND(ISNULL(EESI,0),0)  AS [ESI_EMPLOYER], ROUND(ISNULL([CARLES]/12,0),0) as [CARLES],ROUND(ISNULL([LTA]/12,0),0) as [LTA],ROUND(ISNULL([PTLRIM]/12,0),0) as [CONVEYANCE REIMBURSEMENT],ROUND(ISNULL(DRVRIM,0)/12,0) AS DRVRIM, ROUND(ISNULL(CARMNT,0)/12,0)  AS [FUEL CAR MAINTENANCE], ROUND(ISNULL(PRORIM,0)/12,0)  AS [PROFESSIONAL DEVELOPMENT REIMBURSEMENT], ROUND(ISNULL(ENTRIM,0)/12,0)  AS [ENTERTAINMENT REIMBURSEMENT],ROUND(ISNULL(TELRIM,0)/12,0)  AS TELRIM, ROUND((ISNULL([BASIC]/12,0)+ISNULL([HRA]/12,0)+ISNULL([OTHALL]/12,0)+ISNULL([SPLALL]/12,0)+ISNULL([EDUALL]/12,0)+ISNULL([CARLES]/12,0)+ISNULL([LTA]/12,0)+ISNULL([PTLRIM]/12,0)+ISNULL(MEDRIM,0)/12+ISNULL(TELRIM,0)/12+ISNULL(DRVRIM,0)/12+ISNULL(UNIRIM,0)/12+ISNULL(PRORIM,0)/12+ISNULL(ENTRIM,0)/12+ISNULL(LTARIM,0)/12+ISNULL(NWSRIM,0)/12+ISNULL(CARMNT,0)/12),0)+ISNULL(CTC_PF,0)/12+ISNULL(EESI,0)+ISNULL(ENTRIM/12,0)+ISNULL(FOOD/12,0) +ISNULL(SUDEXO/12,0)+ISNULL([PR_BNS]/12,0)+ISNULL([ST_BNS]/12,0)+ISNULL([PL_ACT]/12,0)+ISNULL([MD_PRM]/12,0) as [MONTHLY CTC] from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,HrdMastQry.FathHusbName,HrdMastQry.DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,HrdMastQry.DOL,HrdMastQry.PANNO, field_name, field_value,RIMHISTQRY.MEDRIM,RIMHISTQRY.TELRIM,RIMHISTQRY.DRVRIM,RIMHISTQRY.UNIRIM, RIMHISTQRY.PTLRIM,RimHistQry.CARMNT,RIMHISTQRY.LTARIM,RIMHISTQRY.NWSRIM,RimHistQry.PRORIM  FROM HRDHISTQRY  LEFT OUTER JOIN HRDMASTQRY ON HRDHISTQRY.EMP_CODE = HRDMASTQRY.EMP_CODE LEFT OUTER JOIN PAYHIST ON HRDHISTQRY.EMP_CODE = PAYHIST.EMP_CODE AND HRDHISTQRY.PAYDATE = PAYHIST.PAYDATE  LEFT OUTER JOIN RIMHISTQRY ON HRDHISTQRY.EMP_CODE = RIMHISTQRY.EMP_CODE AND HRDHISTQRY.PAYDATE = RIMHISTQRY.PAYDATE  LEFT OUTER JOIN PAYMAST ON HRDHISTQRY.EMP_CODE = PAYMAST.EMP_CODE AND PAYMAST.FINYEAR=YEAR(HRDHISTQRY.PAYDATE) WHERE  PAYHIST.PAYDATE BETWEEN @FDATE AND @TDATE AND HRDHISTQRY.Status_Code='01') d  pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[OTHALL],[SPLALL],[MED],[SFTALL],[EDUALL],[LTA],[CARLES],[OSALL],[CTC_ESI],[CTC_BONUS],[CTC_GRAT],[CTC_RTNBNS],[FOOD],[CTC_MEDCLM],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS])) piv
    
    
    
    Select PAYDATE,EMP_CODE,EMP_NAME,FathHusbName as [FATHER'S NAME],DOJ,dob,DOL as [ DOL ],aadhaarno as [AAdhar No],mmobileno as [Mobile no],gender as [Gender],pfno as [PF No],esino as [ESI No],PANNO,ROUND(ISNULL([BASIC]/12,0),0) as BASIC, ROUND(ISNULL([HRA]/12,0),0)  as HRA, ROUND(ISNULL([SPLALL]/12,0),0) as SPLALL,ROUND(ISNULL(convert(float, CTC_PF,0)/12,0),0) AS PF,ROUND(ISNULL(EESI,0),0)  AS [ESI_EMPLOYER], ROUND(ISNULL([CARLES]/12,0),0) as [CARLES],ROUND(ISNULL([LTA]/12,0),0) as [LTA],ROUND(ISNULL([PTLRIM]/12,0),0) as [CONVEYANCE REIMBURSEMENT],ROUND(ISNULL(DRVRIM,0)/12,0) AS DRVRIM, ROUND(ISNULL(CARMNT,0)/12,0)  AS [FUEL CAR MAINTENANCE], ROUND(ISNULL(PRORIM,0)/12,0)  AS [PROFESSIONAL DEVELOPMENT REIMBURSEMENT], ROUND(ISNULL(ENTRIM,0)/12,0)  AS [ENTERTAINMENT REIMBURSEMENT],ROUND(ISNULL(TELRIM,0)/12,0)  AS TELRIM, ROUND((ISNULL([BASIC]/12,0)+ISNULL([HRA]/12,0)+ISNULL([OTHALL]/12,0)+ISNULL([SPLALL]/12,0)+ISNULL([EDUALL]/12,0)+ISNULL([CARLES]/12,0)+ISNULL([LTA]/12,0)+ISNULL([PTLRIM]/12,0)+ISNULL(MEDRIM,0)/12+ISNULL(TELRIM,0)/12+ISNULL(DRVRIM,0)/12+ISNULL(UNIRIM,0)/12+ISNULL(PRORIM,0)/12+ISNULL(ENTRIM,0)/12+ISNULL(LTARIM,0)/12+ISNULL(NWSRIM,0)/12+ISNULL(CARMNT,0)/12),0)+ISNULL(CTC_PF,0)/12+ISNULL(EESI,0)+ISNULL(ENTRIM/12,0)+ISNULL(FOOD/12,0) +ISNULL(SUDEXO/12,0)+ISNULL([PR_BNS]/12,0)+ISNULL([ST_BNS]/12,0)+ISNULL([PL_ACT]/12,0)+ISNULL([MD_PRM]/12,0) as [MONTHLY CTC] from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,HrdMastQry.FathHusbName,HrdMastQry.DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,HrdMastQry.DOL,HrdMastQry.PANNO, field_name, field_value,RIMHISTQRY.MEDRIM,RIMHISTQRY.TELRIM,RIMHISTQRY.DRVRIM,RIMHISTQRY.UNIRIM, RIMHISTQRY.PTLRIM,RimHistQry.CARMNT,RIMHISTQRY.LTARIM,RIMHISTQRY.NWSRIM,RimHistQry.PRORIM  FROM HRDHISTQRY  LEFT OUTER JOIN HRDMASTQRY ON HRDHISTQRY.EMP_CODE = HRDMASTQRY.EMP_CODE LEFT OUTER JOIN PAYHIST ON HRDHISTQRY.EMP_CODE = PAYHIST.EMP_CODE AND HRDHISTQRY.PAYDATE = PAYHIST.PAYDATE  LEFT OUTER JOIN RIMHISTQRY ON HRDHISTQRY.EMP_CODE = RIMHISTQRY.EMP_CODE AND HRDHISTQRY.PAYDATE = RIMHISTQRY.PAYDATE  LEFT OUTER JOIN PAYMAST ON HRDHISTQRY.EMP_CODE = PAYMAST.EMP_CODE AND PAYMAST.FINYEAR=YEAR(HRDHISTQRY.PAYDATE)) d  pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[OTHALL],[SPLALL],[MED],[SFTALL],[EDUALL],[LTA],[CARLES],[OSALL],[CTC_ESI],[CTC_BONUS],[CTC_GRAT],[CTC_RTNBNS],[FOOD],[CTC_MEDCLM],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS])) piv
    group by EMP_CODE,EMP_NAME,FathHusbName,DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,DOL,PANNO,MEDRIM,TELRIM,DRVRIM,UNIRIM, PTLRIM,CARMNT,LTARIM,NWSRIM,PRORIM , BASIC,HRA,SPLALL, CTC_PF,EESI,CARLES,LTA,ENTRIM,OTHALL,EDUALL,FOOD,SUDEXO,PR_BNS,ST_BNS,PL_ACT,MD_PRM,PAYDATE
    
    BMI00056
    
    Select EMP_CODE,EMP_NAME,FathHusbName as [FATHER'S NAME],DOJ,Status_Code,dob,DOL as [ DOL ],aadhaarno as [AAdhar No],mmobileno as [Mobile no],gender as [Gender],pfno as [PF No],esino as [ESI No],PANNO,ROUND(ISNULL([BASIC]/12,0),0) as BASIC, ROUND(ISNULL([HRA]/12,0),0)  as HRA, ROUND(ISNULL([SPLALL]/12,0),0) as SPLALL,ROUND(ISNULL(convert(float, CTC_PF,0)/12,0),0) AS PF,ROUND(ISNULL(EESI,0),0)  AS [ESI_EMPLOYER], ROUND(ISNULL([CARLES]/12,0),0) as [CARLES],ROUND(ISNULL([LTA]/12,0),0) as [LTA],ROUND(ISNULL([PTLRIM]/12,0),0) as [CONVEYANCE REIMBURSEMENT],ROUND(ISNULL(DRVRIM,0)/12,0) AS DRVRIM, ROUND(ISNULL(CARMNT,0)/12,0)  AS [FUEL CAR MAINTENANCE], ROUND(ISNULL(PRORIM,0)/12,0)  AS [PROFESSIONAL DEVELOPMENT REIMBURSEMENT], ROUND(ISNULL(ENTRIM,0)/12,0)  AS [ENTERTAINMENT REIMBURSEMENT],ROUND(ISNULL(TELRIM,0)/12,0)  AS TELRIM, ROUND((ISNULL([BASIC]/12,0)+ISNULL([HRA]/12,0)+ISNULL([OTHALL]/12,0)+ISNULL([SPLALL]/12,0)+ISNULL([EDUALL]/12,0)+ISNULL([CARLES]/12,0)+ISNULL([LTA]/12,0)+ISNULL([PTLRIM]/12,0)+ISNULL(MEDRIM,0)/12+ISNULL(TELRIM,0)/12+ISNULL(DRVRIM,0)/12+ISNULL(UNIRIM,0)/12+ISNULL(PRORIM,0)/12+ISNULL(ENTRIM,0)/12+ISNULL(LTARIM,0)/12+ISNULL(NWSRIM,0)/12+ISNULL(CARMNT,0)/12),0)+ISNULL(CTC_PF,0)/12+ISNULL(EESI,0)+ISNULL(ENTRIM/12,0)+ISNULL(FOOD/12,0) +ISNULL(SUDEXO/12,0)+ISNULL([PR_BNS]/12,0)+ISNULL([ST_BNS]/12,0)+ISNULL([PL_ACT]/12,0)+ISNULL([MD_PRM]/12,0) as [MONTHLY CTC] from ( SELECT HRDHISTQRY.PAYDATE, HRDHISTQRY.EMP_CODE,HRDHISTQRY.EMP_NAME,HrdMastQry.FathHusbName,HrdMastQry.DOJ,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,HrdMastQry.DOL,HrdMastQry.PANNO,hrdmastqry.Status_Code, field_name, field_value,RIMHISTQRY.MEDRIM,RIMHISTQRY.TELRIM,RIMHISTQRY.DRVRIM,RIMHISTQRY.UNIRIM, RIMHISTQRY.PTLRIM,RimHistQry.CARMNT,RIMHISTQRY.LTARIM,RIMHISTQRY.NWSRIM,RimHistQry.PRORIM  FROM HRDHISTQRY  LEFT OUTER JOIN HRDMASTQRY ON HRDHISTQRY.EMP_CODE = HRDMASTQRY.EMP_CODE LEFT OUTER JOIN PAYHIST ON HRDHISTQRY.EMP_CODE = PAYHIST.EMP_CODE AND HRDHISTQRY.PAYDATE = PAYHIST.PAYDATE  LEFT OUTER JOIN RIMHISTQRY ON HRDHISTQRY.EMP_CODE = RIMHISTQRY.EMP_CODE AND HRDHISTQRY.PAYDATE = RIMHISTQRY.PAYDATE  LEFT OUTER JOIN PAYMAST ON HRDHISTQRY.EMP_CODE = PAYMAST.EMP_CODE AND PAYMAST.FINYEAR=YEAR(HRDHISTQRY.PAYDATE) WHERE  HRDHISTQRY.Status_Code in('02','04')) d  pivot ( max(field_value) for field_name in ([BASIC],[HRA],[CONV],[OTHALL],[SPLALL],[MED],[SFTALL],[EDUALL],[LTA],[CARLES],[OSALL],[CTC_ESI],[CTC_BONUS],[CTC_GRAT],[CTC_RTNBNS],[FOOD],[CTC_MEDCLM],[GROSSPAY],[CTC],[PF],[CTC_PF],[ENTRIM],[EESI],[SUDEXO],[PR_BNS],[ST_BNS],[PL_ACT],[MD_PRM],[LEADS])) piv 
   where EESI>0 group by EMP_CODE,EMP_NAME,FathHusbName,DOJ,Status_Code,DOB,AadhaarNo,MMobileNo,Gender,PFNo,ESINo ,DOL,PANNO,MEDRIM,TELRIM,DRVRIM,UNIRIM, PTLRIM,CARMNT,LTARIM,NWSRIM,PRORIM , BASIC,HRA,SPLALL, CTC_PF,EESI,CARLES,LTA,ENTRIM,OTHALL,EDUALL,FOOD,SUDEXO,PR_BNS,ST_BNS,PL_ACT,MD_PRM
   